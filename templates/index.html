<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Python Chatbot</title>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --accent:#3b82f6; --text:#e5e7eb; --muted:#9ca3af; }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 100% -10%, #1f2937 0, #0b1220 50%, #070b14 100%);
      color: var(--text); display: grid; place-items: center; min-height: 100svh; padding: 24px;
    }
    .app {
      width: 100%; max-width: 820px; background: rgba(17,24,39,.6); backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,.06); border-radius: 20px; overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,.35);
    }
    .header { padding: 16px 20px; border-bottom: 1px solid rgba(255,255,255,.06); display:flex; gap:12px; align-items:center; }
    .dot { width:10px; height:10px; border-radius:50%; background:#ef4444; box-shadow: 16px 0 0 #f59e0b, 32px 0 0 #22c55e; }
    .title { font-weight: 700; letter-spacing:.2px; }
    .chat {
      height: 60vh; min-height: 380px; max-height: 70vh; overflow-y: auto; padding: 18px 18px 0;
      display: flex; flex-direction: column; gap: 10px; scroll-behavior: smooth;
    }
    .msg { max-width: 78%; padding: 10px 12px; border-radius: 14px; line-height: 1.35; word-wrap: break-word; }
    .user { align-self: flex-end; background: #1d4ed8; }
    .bot  { align-self: flex-start; background: #0b1220; border: 1px solid rgba(255,255,255,.06); }
    .meta { font-size: 12px; color: var(--muted); margin: 2px 4px 0; }
    .inputbar {
      display: flex; gap: 10px; padding: 12px; border-top: 1px solid rgba(255,255,255,.06); background: rgba(0,0,0,.25);
    }
    input[type="text"] {
      flex: 1; padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04); color: var(--text); outline: none;
    }
    button {
      padding: 12px 16px; border-radius: 12px; border: 1px solid rgba(255,255,255,.08);
      background: var(--accent); color: white; font-weight: 600; cursor: pointer;
    }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .hint { padding: 8px 14px 16px; color: var(--muted); font-size: 12px; text-align:center; }
    @media (max-width: 520px) { .msg { max-width: 90%; } }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="dot"></div>
      <div class="title">Python Chatbot</div>
    </div>

    <div id="chat" class="chat"></div>

    <div class="inputbar">
      <input id="message" type="text" placeholder="Type your message..." autocomplete="off" />
      <button id="send">Send</button>
    </div>
    <div class="hint">Tip: press Enter to send. Your messages stay in your browser only.</div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("message");
    const sendBtn = document.getElementById("send");

    function addMessage(text, who = "bot") {
      const wrap = document.createElement("div");
      const bubble = document.createElement("div");
      bubble.className = "msg " + (who === "user" ? "user" : "bot");
      bubble.textContent = text;
      wrap.appendChild(bubble);

      const meta = document.createElement("div");
      meta.className = "meta";
      const now = new Date();
      meta.textContent = (who === "user" ? "You" : "Bot") + " â€¢ " +
                         now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
      wrap.appendChild(meta);

      chat.appendChild(wrap);
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      addMessage(text, "user");
      input.value = "";
      input.focus();
      sendBtn.disabled = true;

      // Optional: show a tiny typing indicator
      const typingId = "typing-" + Math.random().toString(36).slice(2);
      const typing = document.createElement("div");
      typing.id = typingId;
      typing.className = "msg bot";
      typing.textContent = "â€¦";
      chat.appendChild(typing);
      chat.scrollTop = chat.scrollHeight;

      try {
        const res = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        chat.removeChild(typing);

        if (!res.ok) {
          addMessage(data?.response || "Something went wrong.", "bot");
        } else {
          addMessage(data.response, "bot");
        }
      } catch (e) {
        chat.removeChild(typing);
        addMessage("Network error. Please try again.", "bot");
      } finally {
        sendBtn.disabled = false;
      }
    }

    sendBtn.addEventListener("click", sendMessage);
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    // Greet on load
    addMessage("Hello! Iâ€™m your Python chatbot. Ask me something ðŸ‘‹", "bot");
  </script>
</body>
</html>
